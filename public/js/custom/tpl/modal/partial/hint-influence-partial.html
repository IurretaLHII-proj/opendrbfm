<div class="form-group mb-1">
	<!--<h6>Notes</h6>-->
	<div class="form-row" ng-repeat="(i, note) in values.notes">
		<div class="form-group col-11">
			<div class="input-group">
				<text-angular 
					ng-model="note.text"
					ta-toolbar="[
						['bold', 'italics', 'underline' ],
				   		['ul', 'insertLink', 'html'],
					]"
					ta-text-editor-class="form-height form-control"
					ng-class="{'is-invalid': errors.notes[i].text}"
					placeholder="Describe influence.."
					class="small-area"
				>
				</text-angular>
				<div ng-if="errors.notes[i].text"
					ng-repeat="(key, text) in errors.notes[i].text"
					class="small text-danger">{[key]}. {[text]}</div>
			</div>
		</div>
		<div class="form-group col-1 m-auto">
			<a href="" class="btn pull-right" ng-click="values.notes.splice(i, 1);">
				<span class="fa fa-close"></span>
			</a>
		</div>
	</div>
</div>

<div class="form-group mb-1">
	<!--<h6>Relations</h6>-->
	<div class="form-row" ng-repeat="(i, value) in values.relations">
		<div class="form-group col-4">
			<select class="form-control"
				ng-model="value.source.stage"
				ng-options="item.id as item.name for item in [dflt].concat(nextStages)"
				ng-init="loadNextHints(value)"
				ng-change="loadNextHints(value)"
				>
			</select>
		</div>
		<div class="form-group col-8">
			<div class="input-group">
				<div class="input-group-prepend">
					<span class="input-group-text border-right-0">
						<i class="fa fa-circle-o-notch" ng-class="{'fa-spin': nextsLoading[i]}"></i>
					</span>
		    	</div>
				<select class="form-control"
					ng-disabled="!value.source.stage"
					ng-class="{'is-invalid': errors.relations[i].source.hint}"
					ng-model="value.source.hint"
					ng-options="item.id as item.name for item in value.nexts"
					ng-change="createNextHint(value)"
					>
				</select>
				<div class="input-group-append">
					<span class="input-group-button">
						<a href="" class="btn" ng-click="values.relations.splice(i, 1);">
							<span class="fa fa-close"></span>
						</a>
					</span>
		    	</div>
				<div ng-if="errors.relations[i].source.hint"
					ng-repeat="(key, text) in errors.relations[i].source.hint"
					class="invalid-feedback">{[key]}. {[text]}</div>
				</div>
		</div>
		<div class="form-group col-12">
			<text-angular 
				ng-model="value.description"
				ta-toolbar="[
					['bold', 'italics', 'underline' ],
			   		['ul', 'insertLink', 'html'],
				]"
				ta-text-editor-class="form-height form-control"
				ng-class="{'is-invalid': errors.relations[i].description}"
				placeholder="Description.."
			>
			</text-angular>
			<div ng-if="errors.relations[i].description"
				ng-repeat="(key, text) in errors.relations[i].description"
				class="text-danger">{[key]}. {[text]}</div>
		</div>
	</div>
</div>

<div ng-if="values.simulations.length" class="form-group mb-1 border p-2">
	<!--<h6>Simulations</h6>-->
	<div class="form-group" ng-repeat="(i, simulation) in values.simulations" style="position: relative">
		<a href="" class="btn" ng-click="values.simulations.splice(i, 1);" style="
			position: absolute;
			top: 0;
			right: 0;
		">
			<span class="fa fa-close"></span>
		</a>
		<div class="btn-group">
			<a href="" class="btn btn-primary disabled">Simulation</a>
			<a href="" class="btn btn-outline-primary" 
				ng-click="addSuggestion(simulation)">
				<span class="fa fa-plus"></span> Suggestion
			</a>
		</div>
		<div class="form-row my-2" ng-repeat="(j, suggestion) in simulation.suggestions">
			<div class="form-group col-11">
				<div class="input-group">
					<text-angular 
						ng-model="suggestion.text"
						ta-toolbar="[
							['bold', 'italics', 'underline' ],
					   		['ul', 'insertLink', 'html'],
						]"
						ta-text-editor-class="form-height form-control"
						ng-class="{'is-invalid': errors.simulations[i].suggestions[j].text}"
						placeholder="Describe suggestion.."
						class="small-area"
					>
					</text-angular>
					<div ng-if="errors.simulations[i].suggestions[j].text"
						ng-repeat="(key, text) in errors.simulations[i].suggestions[j].text"
						class="small text-danger">{[key]}. {[text]}</div>
				</div>
			</div>
			<div class="form-group col-1 m-auto">
				<a href="" class="btn pull-right" ng-click="simulation.suggestions.splice(j, 1);">
					<span class="fa fa-close"></span>
				</a>
			</div>
		</div>
	</div>
</div>
