<div class="modal-header">
	<h3 class="modal-title">{[ relation.name ]} <small class="text-secondary" ng-if="relation.id">| edit relation</small><small class="text-secondary" ng-if="!relation.id">| new relation</small></h3>
</div>
<div class="modal-body">
	<div class="form-row" ng-if="r">
		<div class="form-group col-4">
			<select class="form-control"
				ng-model="values.source.stage"
				ng-options="item.id as item.name for item in [dflt].concat(prevStages)"
				ng-init="loadPreviousHints()"
				ng-change="loadPreviousHints()"
				>
			</select>
		</div>
		<div class="form-group col-8">
			<div class="input-group">
				<div class="input-group-prepend">
					<span class="input-group-text border-right-0">
						<i class="fa fa-circle-o-notch" ng-class="{'fa-spin': prevsLoading}"></i>
					</span>
		    	</div>
				<select class="form-control"
					ng-disabled="!values.source.stage || prevsLoading"
					ng-class="{'is-invalid': errors.source.hint}"
					ng-model="values.source.hint"
					ng-options="item.id as item.name for item in previouses
					">
				</select>
				<div ng-if="errors.source.hint"
					ng-repeat="(key, text) in errors.source.hint"
					class="invalid-feedback">{[key]}. {[text]}</div>
				</div>
		</div>
	</div>
	<div class="form-row" ng-if="!r">
		<div class="form-group col-4">
			<select class="form-control"
				ng-model="values.relation.stage"
				ng-options="item.id as item.name for item in [dflt].concat(nextStages)"
				ng-init="loadNextHints()"
				ng-change="loadNextHints()"
				>
			</select>
		</div>
		<div class="form-group col-8">
			<div class="input-group">
				<div class="input-group-prepend">
					<span class="input-group-text border-right-0">
						<i class="fa fa-circle-o-notch" ng-class="{'fa-spin': nextsLoading}"></i>
					</span>
		    	</div>
				<select class="form-control"
					ng-disabled="!values.relation.stage || nextsLoading"
					ng-class="{'is-invalid': errors.relation.hint}"
					ng-model="values.relation.hint"
					ng-options="item.id as item.name for item in nexts
					">
				</select>
				<div ng-if="errors.relation.hint"
					ng-repeat="(key, text) in errors.relation.hint"
					class="invalid-feedback">{[key]}. {[text]}</div>
				</div>
		</div>
	</div>
	<div class="form-group">
		<text-angular 
			ng-model="values.description"
			ta-toolbar="[
				['bold', 'italics', 'underline' ],
		   		['ul', 'insertLink', 'html'],
			]"
			ta-text-editor-class="form-height form-control"
			ng-class="{'is-invalid': errors.description}"
			class=""
		>
		</text-angular>
		<div ng-if="errors.description"
			ng-repeat="(key, text) in errors.description"
			class="text-danger">{[key]}. {[text]}</div>
	</div>
</div>
<div class="modal-footer">
	<a href="" class="btn btn-secondary" ng-click="cancel()">Cancel</a>
	<a href="" class="btn btn-success" ng-click="save()">Save</a>
</div>

